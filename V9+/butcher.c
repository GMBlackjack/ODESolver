#include "nrpy_odiegm.h"

//A collection of butcher tables, courtesy of NRPy+.
//This file should never be run in isolation. It just has object definitions. 

//double butcher[2][2] = {{0.0,0},{1.0,1.0}};
//const nrpy_odiegm_step_type s, *nrpy_odiegm_step_euler;
//nrpy_odiegm_step_euler = &s;
//const nrpy_odiegm_step_type *nrpy_odiegm_step_euler;
//nrpy_odiegm_step_euler->order = 1;

double butcherEuler[2][2] = {{0.0,0},{1.0,1.0}};
const nrpy_odiegm_step_type nrpy_odiegm_step_euler0 = {2,2,&butcherEuler};
const nrpy_odiegm_step_type *nrpy_odiegm_step_euler = &nrpy_odiegm_step_euler0;

double butcherRK2H[3][3] = {{0.0,0,0},{1.0,1.0,0},{2.0,0.5,0.5}};
const nrpy_odiegm_step_type nrpy_odiegm_step_RK2_Heun0 = {3,3,&butcherRK2H};
const nrpy_odiegm_step_type *nrpy_odiegm_step_RK2_Heun = &nrpy_odiegm_step_RK2_Heun0;

double butcherRK2MP[3][3] = {{0.0,0,0},{0.5,0.5,0},{2.0,0.0,1.0}};
const nrpy_odiegm_step_type nrpy_odiegm_step_RK2_MP0 = {3,3,&butcherRK2MP};
const nrpy_odiegm_step_type *nrpy_odiegm_step_RK2_MP = &nrpy_odiegm_step_RK2_MP0;

double butcherRK2R[3][3] = {{0.0,0,0},{0.6666666666666666,0.6666666666666666,0},{2.0,0.25,0.75}};
const nrpy_odiegm_step_type nrpy_odiegm_step_RK2_R0 = {3,3,&butcherRK2R};
const nrpy_odiegm_step_type *nrpy_odiegm_step_RK2_Ralston = &nrpy_odiegm_step_RK2_R0;

double butcherRK3[4][4] = {{0.0,0,0,0},{0.5,0.5,0,0},{1.0,-1.0,2.0,0},{3.0,0.16666666666666666,0.6666666666666666,0.16666666666666666}};
const nrpy_odiegm_step_type nrpy_odiegm_step_RK3_0 = {4,4,&butcherRK3};
const nrpy_odiegm_step_type *nrpy_odiegm_step_RK3 = &nrpy_odiegm_step_RK3_0;

double butcherRK3H[4][4] = {{0.0,0,0,0},{0.3333333333333333,0.3333333333333333,0,0},{0.6666666666666666,0.0,0.6666666666666666,0},{3.0,0.25,0.0,0.75}};
const nrpy_odiegm_step_type nrpy_odiegm_step_RK3_H0 = {4,4,&butcherRK3H};
const nrpy_odiegm_step_type *nrpy_odiegm_step_RK3_Heun = &nrpy_odiegm_step_RK3_H0;

double butcherRK3R[4][4] = {{0.0,0,0,0},{0.5,0.5,0,0},{0.75,0.0,0.75,0},{3.0,0.2222222222222222,0.3333333333333333,0.4444444444444444}};
const nrpy_odiegm_step_type nrpy_odiegm_step_RK3_R0 = {4,4,&butcherRK3R};
const nrpy_odiegm_step_type *nrpy_odiegm_step_RK3_Ralston = &nrpy_odiegm_step_RK3_R0;

double butcherRK3S[4][4] = {{0.0,0,0,0},{1.0,1.0,0,0},{0.5,0.25,0.25,0},{3.0,0.16666666666666666,0.16666666666666666,0.6666666666666666}};
const nrpy_odiegm_step_type nrpy_odiegm_step_RK3_S0 = {4,4,&butcherRK3S};
const nrpy_odiegm_step_type *nrpy_odiegm_step_SSPRK3 = &nrpy_odiegm_step_RK3_S0;

double butcherRK4[5][5] = {{0.0,0,0,0,0},{0.5,0.5,0,0,0},{0.5,0.0,0.5,0,0},{1.0,0.0,0.0,1.0,0},{4.0,0.16666666666666666,0.3333333333333333,0.3333333333333333,0.16666666666666666}};
const nrpy_odiegm_step_type nrpy_odiegm_step_RK4_0 = {5,5,&butcherRK4};
const nrpy_odiegm_step_type *nrpy_odiegm_step_RK4 = &nrpy_odiegm_step_RK4_0;

double butcherDP5[8][8] = {{0.0,0,0,0,0,0,0,0},{0.2,0.2,0,0,0,0,0,0},{0.3,0.075,0.225,0,0,0,0,0},{0.8,0.9777777777777777,-3.7333333333333334,3.5555555555555554,0,0,0,0},{0.8888888888888888,2.9525986892242035,-11.595793324188385,9.822892851699436,-0.2908093278463649,0,0,0},{1.0,2.8462752525252526,-10.757575757575758,8.906422717743473,0.2784090909090909,-0.2735313036020583,0,0},{1.0,0.09114583333333333,0.0,0.44923629829290207,0.6510416666666666,-0.322376179245283,0.13095238095238096,0},{5.0,0.09114583333333333,0.0,0.44923629829290207,0.6510416666666666,-0.322376179245283,0.13095238095238096,0.0}};
const nrpy_odiegm_step_type nrpy_odiegm_step_DP5_0 = {8,8,&butcherDP5};
const nrpy_odiegm_step_type *nrpy_odiegm_step_DP5 = &nrpy_odiegm_step_DP5_0;

double butcherDP5A[8][8] = {{0.0,0,0,0,0,0,0,0},{0.1,0.1,0,0,0,0,0,0},{0.2222222222222222,-0.024691358024691357,0.24691358024691357,0,0,0,0,0},{0.42857142857142855,0.44825072886297374,-0.7871720116618076,0.7674927113702624,0,0,0,0},{0.6,0.5896363636363636,-0.9818181818181818,0.7125734265734266,0.2796083916083916,0,0,0},{0.8,-0.7135892255892256,1.309090909090909,0.12012834224598931,-0.652013468013468,0.7363834422657952,0,0},{1.0,2.3404882154882154,-3.1818181818181817,-0.7631237540739804,4.482612117227502,-2.8458605664488017,0.9677021696252466,0},{5.0,0.07601851851851851,0.0,0.27404107205012185,0.19205895244356783,0.10757080610021787,0.29031065088757396,0.06}};
const nrpy_odiegm_step_type nrpy_odiegm_step_DP5A_0 = {8,8,&butcherDP5A};
const nrpy_odiegm_step_type *nrpy_odiegm_step_DP5alt = &nrpy_odiegm_step_DP5A_0;

double butcherCK5[7][7] = {{0.0,0,0,0,0,0,0},{0.2,0.2,0,0,0,0,0},{0.3,0.075,0.225,0,0,0,0},{0.6,0.3,-0.9,1.2,0,0,0},{1.0,-0.2037037037037037,2.5,-2.5925925925925926,1.2962962962962963,0,0},{0.875,0.029495804398148147,0.341796875,0.041594328703703706,0.40034541377314814,0.061767578125,0},{5.0,0.09788359788359788,0.0,0.4025764895330113,0.21043771043771045,0.0,0.2891022021456804}};
const nrpy_odiegm_step_type nrpy_odiegm_step_CK5_0 = {7,7,&butcherCK5};
const nrpy_odiegm_step_type *nrpy_odiegm_step_CK5 = &nrpy_odiegm_step_CK5_0;

double butcherDP6[9][9] = {{0.0,0,0,0,0,0,0,0,0},{0.1,0.1,0,0,0,0,0,0,0},{0.2222222222222222,-0.024691358024691357,0.24691358024691357,0,0,0,0,0,0},{0.42857142857142855,0.44825072886297374,-0.7871720116618076,0.7674927113702624,0,0,0,0,0},{0.6,0.5896363636363636,-0.9818181818181818,0.7125734265734266,0.2796083916083916,0,0,0,0},{0.8,-0.7135892255892256,1.309090909090909,0.12012834224598931,-0.652013468013468,0.7363834422657952,0,0,0},{1.0,2.3404882154882154,-3.1818181818181817,-0.7631237540739804,4.482612117227502,-2.8458605664488017,0.9677021696252466,0,0},{1.0,1.74913946007696,-2.3904220779220777,-0.3962525737836824,3.272858329348714,-2.063516378773732,0.828193241053818,0.0,0},{6.0,0.07060185185185185,0.0,0.30584941077022526,0.11510382423843962,0.18722766884531591,0.25425295857988167,-0.033035714285714286,0.1}};
const nrpy_odiegm_step_type nrpy_odiegm_step_DP6_0 = {9,9,&butcherDP6};
const nrpy_odiegm_step_type *nrpy_odiegm_step_DP6 = &nrpy_odiegm_step_DP6_0;

double butcherL6[8][8] = {{0.0,0,0,0,0,0,0,0},{1.0,1.0,0,0,0,0,0,0},{0.5,0.375,0.125,0,0,0,0,0},{0.6666666666666666,0.2962962962962963,0.07407407407407407,0.2962962962962963,0,0,0,0},{0.17267316464601143,0.051640768506639186,-0.04933518989886041,0.2960111393931624,-0.1256435533549298,0,0,0},{0.8273268353539885,-1.1854881643947648,-0.2363790958154253,-0.7481756236662596,0.8808545802392703,2.116515138991168,0,0},{1.0,4.50650248872424,0.6666666666666666,6.017339969931307,-4.111704479703632,-7.018914097580199,0.9401094519616178,0},{6.0,0.05,0.0,0.35555555555555557,0.0,0.2722222222222222,0.2722222222222222,0.05}};
const nrpy_odiegm_step_type nrpy_odiegm_step_L6_0 = {8,8,&butcherL6};
const nrpy_odiegm_step_type *nrpy_odiegm_step_L6 = &nrpy_odiegm_step_L6_0;

double butcherDP8[14][14] = {{0.0,0,0,0,0,0,0,0,0,0,0,0,0,0},{0.05555555555555555,0.05555555555555555,0,0,0,0,0,0,0,0,0,0,0,0},{0.08333333333333333,0.020833333333333332,0.0625,0,0,0,0,0,0,0,0,0,0,0},{0.125,0.03125,0.0,0.09375,0,0,0,0,0,0,0,0,0,0},{0.3125,0.3125,0.0,-1.171875,1.171875,0,0,0,0,0,0,0,0,0},{0.375,0.0375,0.0,0.0,0.1875,0.15,0,0,0,0,0,0,0,0},{0.1475,0.04791013711111111,0.0,0.0,0.11224871277777777,-0.02550567377777778,0.012846823888888888,0,0,0,0,0,0,0},{0.465,0.01691798978729228,0.0,0.0,0.3878482784860432,0.03597736985150033,0.19697021421566607,-0.17271385234050185,0,0,0,0,0,0},{0.5648654513822595,0.0690957533591923,0.0,0.0,-0.6342479767288541,-0.16119757522460407,0.13865030945882525,0.9409286140357562,0.21163632648194397,0,0,0,0,0},{0.65,0.1835569968390454,0.0,0.0,-2.4687680843155926,-0.29128688781630047,-0.026473020233117376,2.8478387641928005,0.2813873314698498,0.12374489986331466,0,0,0,0},{0.9246562776405044,-1.2154248173958881,0.0,0.0,16.672608665945774,0.915741828416818,-6.056605804357471,-16.00357359415618,14.849303086297663,-13.371575735289849,5.134182648179638,0,0,0},{1.0,0.25886091643826425,0.0,0.0,-4.774485785489205,-0.4350930137770325,-3.0494833320722416,5.5779200399360995,6.15583158986104,-5.062104586736939,2.193926173180679,0.13462799865933495,0,0},{1.0,0.8224275996265075,0.0,0.0,-11.658673257277664,-0.7576221166909362,0.7139735881595816,12.075774986890057,-2.127659113920403,1.9901662070489554,-0.23428647154404028,0.17589857770794226,0.0,0},{8.0,0.041747491141530244,0.0,0.0,0.0,0.0,-0.05545232861123931,0.2393128072011801,0.703510669403443,-0.7597596138144609,0.6605630309222863,0.15818748251012332,-0.2381095387528628,0.25}};
const nrpy_odiegm_step_type nrpy_odiegm_step_DP8_0 = {14,14,&butcherDP8};
const nrpy_odiegm_step_type *nrpy_odiegm_step_DP8 = &nrpy_odiegm_step_DP8_0;

//Adaptive Methods
double butcherAEH[4][3] = {{0.0,0,0},{1.0,1.0,0},{2.0,0.5,0.5},{2.0,1.0,0.0}};
const nrpy_odiegm_step_type nrpy_odiegm_step_AEH_0 = {4,3,&butcherAEH};
const nrpy_odiegm_step_type *nrpy_odiegm_step_AEH = &nrpy_odiegm_step_AEH_0;

double butcherABS[6][5] = {{0.0,0,0,0,0},{0.5,0.5,0,0,0},{0.75,0.0,0.75,0,0},{1.0,0.2222222222222222,0.3333333333333333,0.4444444444444444,0},{3.0,0.2222222222222222,0.3333333333333333,0.4444444444444444,0.0},{3.0,0.2916666666666667,0.25,0.3333333333333333,0.125}};
const nrpy_odiegm_step_type nrpy_odiegm_step_ABS_0 = {6,5,&butcherABS};
const nrpy_odiegm_step_type *nrpy_odiegm_step_ABS = &nrpy_odiegm_step_ABS_0;

double butcherARKF[8][7] = {{0.0,0,0,0,0,0,0},{0.25,0.25,0,0,0,0,0},{0.375,0.09375,0.28125,0,0,0,0},{0.9230769230769231,0.8793809740555303,-3.277196176604461,3.3208921256258535,0,0,0},{1.0,2.0324074074074074,-8.0,7.173489278752436,-0.20589668615984405,0,0},{0.5,-0.2962962962962963,2.0,-1.3816764132553607,0.4529727095516569,-0.275,0},{5.0,0.11851851851851852,0.0,0.5189863547758284,0.5061314903420167,-0.18,0.03636363636363636},{5.0,0.11574074074074074,0.0,0.5489278752436647,0.5353313840155945,-0.2,0.0}};
const nrpy_odiegm_step_type nrpy_odiegm_step_ARKF_0 = {8,7,&butcherARKF};
const nrpy_odiegm_step_type *nrpy_odiegm_step_ARKF = &nrpy_odiegm_step_ARKF_0;

double butcherACK[8][7] = {{0.0,0,0,0,0,0,0},{0.2,0.2,0,0,0,0,0},{0.3,0.075,0.225,0,0,0,0},{0.6,0.3,-0.9,1.2,0,0,0},{1.0,-0.2037037037037037,2.5,-2.5925925925925926,1.2962962962962963,0,0},{0.875,0.029495804398148147,0.341796875,0.041594328703703706,0.40034541377314814,0.061767578125,0},{5.0,0.09788359788359788,0.0,0.4025764895330113,0.21043771043771045,0.0,0.2891022021456804},{5.0,0.10217737268518519,0.0,0.38390790343915343,0.24459273726851852,0.019321986607142856,0.25}};
const nrpy_odiegm_step_type nrpy_odiegm_step_ACK_0 = {8,7,&butcherACK};
const nrpy_odiegm_step_type *nrpy_odiegm_step_ACK = &nrpy_odiegm_step_ACK_0;

double butcherADP5[9][8] = {{0.0,0,0,0,0,0,0,0},{0.2,0.2,0,0,0,0,0,0},{0.3,0.075,0.225,0,0,0,0,0},{0.8,0.9777777777777777,-3.7333333333333334,3.5555555555555554,0,0,0,0},{0.8888888888888888,2.9525986892242035,-11.595793324188385,9.822892851699436,-0.2908093278463649,0,0,0},{1.0,2.8462752525252526,-10.757575757575758,8.906422717743473,0.2784090909090909,-0.2735313036020583,0,0},{1.0,0.09114583333333333,0.0,0.44923629829290207,0.6510416666666666,-0.322376179245283,0.13095238095238096,0},{5.0,0.09114583333333333,0.0,0.44923629829290207,0.6510416666666666,-0.322376179245283,0.13095238095238096,0.0},{5.0,0.08991319444444444,0.0,0.4534890685834082,0.6140625,-0.2715123820754717,0.08904761904761904,0.025}};
const nrpy_odiegm_step_type nrpy_odiegm_step_ADP5_0 = {9,8,&butcherADP5};
const nrpy_odiegm_step_type *nrpy_odiegm_step_ADP5 = &nrpy_odiegm_step_ADP5_0;

double butcherADP8[15][14] = {{0.0,0,0,0,0,0,0,0,0,0,0,0,0,0},{0.05555555555555555,0.05555555555555555,0,0,0,0,0,0,0,0,0,0,0,0},{0.08333333333333333,0.020833333333333332,0.0625,0,0,0,0,0,0,0,0,0,0,0},{0.125,0.03125,0.0,0.09375,0,0,0,0,0,0,0,0,0,0},{0.3125,0.3125,0.0,-1.171875,1.171875,0,0,0,0,0,0,0,0,0},{0.375,0.0375,0.0,0.0,0.1875,0.15,0,0,0,0,0,0,0,0},{0.1475,0.04791013711111111,0.0,0.0,0.11224871277777777,-0.02550567377777778,0.012846823888888888,0,0,0,0,0,0,0},{0.465,0.01691798978729228,0.0,0.0,0.3878482784860432,0.03597736985150033,0.19697021421566607,-0.17271385234050185,0,0,0,0,0,0},{0.5648654513822595,0.0690957533591923,0.0,0.0,-0.6342479767288541,-0.16119757522460407,0.13865030945882525,0.9409286140357562,0.21163632648194397,0,0,0,0,0},{0.65,0.1835569968390454,0.0,0.0,-2.4687680843155926,-0.29128688781630047,-0.026473020233117376,2.8478387641928005,0.2813873314698498,0.12374489986331466,0,0,0,0},{0.9246562776405044,-1.2154248173958881,0.0,0.0,16.672608665945774,0.915741828416818,-6.056605804357471,-16.00357359415618,14.849303086297663,-13.371575735289849,5.134182648179638,0,0,0},{1.0,0.25886091643826425,0.0,0.0,-4.774485785489205,-0.4350930137770325,-3.0494833320722416,5.5779200399360995,6.15583158986104,-5.062104586736939,2.193926173180679,0.13462799865933495,0,0},{1.0,0.8224275996265075,0.0,0.0,-11.658673257277664,-0.7576221166909362,0.7139735881595816,12.075774986890057,-2.127659113920403,1.9901662070489554,-0.23428647154404028,0.17589857770794226,0.0,0},{8.0,0.041747491141530244,0.0,0.0,0.0,0.0,-0.05545232861123931,0.2393128072011801,0.703510669403443,-0.7597596138144609,0.6605630309222863,0.15818748251012332,-0.2381095387528628,0.25},{8.0,0.0295532136763535,0.0,0.0,0.0,0.0,-0.828606276487797,0.3112409000511183,2.467345190599887,-2.546941651841909,1.4435485836767752,0.07941559588112729,0.044444444444444446,0.0}};
const nrpy_odiegm_step_type nrpy_odiegm_step_ADP8_0 = {15,14,&butcherADP8};
const nrpy_odiegm_step_type *nrpy_odiegm_step_ADP8 = &nrpy_odiegm_step_ADP8_0;

//Adams-Bashforth Method. Notably just has a "1", because this table can be constructed at runtime. 
double butcherAB[1][1] = {1.0};
const nrpy_odiegm_step_type nrpy_odiegm_step_AB0 = {1,1,&butcherAB};
const nrpy_odiegm_step_type *nrpy_odiegm_step_AB = &nrpy_odiegm_step_AB0;